{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Evan_\\\\stream-dolby-voxeet\\\\src\\\\components\\\\Modal\\\\Modal.js\";\nimport React, { Component, cloneElement } from 'react';\nimport PropTypes from 'prop-types';\nimport keycode from 'keycode';\nimport styled from 'styled-components';\nimport Animated from 'animated/lib/targets/react-dom';\nimport Easing from 'animated/lib/Easing'; // Utils //\n\nimport GetRef from 'utils/GetRef';\nimport Portal from 'utils/Portal'; // Components //\n\nimport Undersheet from './Undersheet';\nconst ModalRoot = styled(Animated.div)`\n    display: flex;\n    flex-direction: row;\n    justify-content: center;\n    position: fixed;\n    z-index: ${({\n  theme\n}) => theme.z.modal};\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n    visibility: ${({\n  isHidden\n}) => isHidden ? 'hidden' : 'visible'};\n`;\n\nclass Modal extends Component {\n  static getDerivedStateFromProps(nextProps) {\n    if (nextProps.open) {\n      return {\n        exited: false\n      };\n    }\n\n    return null;\n  }\n\n  constructor(props) {\n    super(props);\n    this._anim = new Animated.Value(0);\n\n    this.handleOpen = () => {\n      const {\n        animated,\n        duration,\n        openDuration\n      } = this.props;\n      document.addEventListener('keydown', this.handleDocumentKeyDown);\n\n      if (animated) {\n        Animated.timing(this.animatedValue, {\n          toValue: 1,\n          duration: openDuration || duration,\n          easing: Easing.bezier(0.0, 0.0, 0.2, 1)\n        }).start(() => this.handleOpened());\n      } else {\n        this.animatedValue.setValue(1);\n        this.handleOpened();\n      }\n    };\n\n    this.handleRendered = () => {\n      if (this.props.onRendered) {\n        this.props.onRendered();\n      }\n\n      if (this.props.open) {\n        this.handleOpened();\n      }\n    };\n\n    this.handleOpened = () => {\n      // Fix a bug on Chrome where the scroll isn't initially 0.\n      if (this.modalRef) {\n        this.modalRef.scrollTop = 0;\n      }\n    };\n\n    this.handleClose = () => {\n      const {\n        animated,\n        closeDuration,\n        duration\n      } = this.props;\n      document.removeEventListener('keydown', this.handleDocumentKeyDown);\n\n      if (animated) {\n        Animated.timing(this.animatedValue, {\n          toValue: 0,\n          overshootClamping: true,\n          duration: closeDuration || duration,\n          easing: Easing.bezier(0.4, 0.0, 1, 1)\n        }).start(() => this.handleExited());\n      } else {\n        this.animatedValue.setValue(0);\n        this.handleExited();\n      }\n    };\n\n    this.handleExited = () => {\n      this.setState({\n        exited: true\n      });\n    };\n\n    this.handleUndersheetClick = e => {\n      if (e.target !== e.currentTarget) {\n        return;\n      }\n\n      if (this.props.onClose) {\n        this.props.onClose(e);\n      }\n    };\n\n    this.handleDocumentKeyDown = e => {\n      // Ignore events that have been `e.preventDefault()` marked.\n      if (keycode(e) !== 'esc' || e.defaultPrevented) {\n        return;\n      }\n\n      if (this.props.onEscapeKeyDown) {\n        this.props.onEscapeKeyDown(e);\n      }\n\n      if (!this.props.disableEscapeKeyDown && this.props.onClose) {\n        this.props.onClose(e);\n      }\n    };\n\n    this.handlePortalRef = ref => {\n      this.mountNode = ref ? ref.getMountNode() : ref;\n    };\n\n    this.handleModalRef = ref => {\n      this.modalRef = ref;\n    };\n\n    this.onRootRef = ref => {\n      this.dialogRef = ref;\n    };\n\n    this.animatedValue = props.hasOwnProperty('animatedValue') ? this.props.animatedValue : this._anim; // eslint-disable-line no-prototype-builtins\n\n    this.state = {\n      exited: !props.open\n    };\n  }\n\n  componentDidMount() {\n    if (this.props.open) {\n      this.handleOpen();\n    }\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.open && !this.props.open) {\n      this.handleClose();\n    } else if (!prevProps.open && this.props.open) {\n      this.handleOpen();\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.props.open || !this.state.exited) {\n      this.handleClose();\n    }\n  }\n\n  get defaultUndersheetAnim() {\n    const {\n      inputRange\n    } = this.props;\n    return {\n      opacity: this.animatedValue.interpolate({\n        inputRange,\n        outputRange: [0, 1]\n      })\n    };\n  }\n\n  render() {\n    const {\n      children,\n      container,\n      disablePortal,\n      lockScroll,\n      showUndersheet,\n      undersheet: UndersheetComponent,\n      undersheetStyle,\n      open,\n      onClose,\n      ...other\n    } = this.props;\n    const {\n      exited\n    } = this.state;\n    return /*#__PURE__*/React.createElement(Portal, {\n      ref: this.handlePortalRef,\n      container: container,\n      disablePortal: disablePortal,\n      unmount: exited,\n      onRendered: this.handleRendered,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(ModalRoot, Object.assign({\n      isHidden: exited,\n      ref: this.handleModalRef\n    }, other, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(UndersheetComponent, {\n      pointerEvents: open ? 'auto' : 'none',\n      show: showUndersheet,\n      open: !exited,\n      style: undersheetStyle || this.defaultUndersheetAnim,\n      onClick: open ? this.handleUndersheetClick : undefined,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(GetRef, {\n      rootRef: this.onRootRef,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 21\n      }\n    }, !exited ? cloneElement(children, {\n      onClose\n    }) : null), /*#__PURE__*/React.createElement(ScrollLock, {\n      isActive: !exited && lockScroll,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 21\n      }\n    })));\n  }\n\n}\n\nModal.propTypes = {\n  animated: PropTypes.bool,\n  animatedValue: PropTypes.instanceOf(Animated.Value),\n  children: PropTypes.element,\n  className: PropTypes.string,\n  closeDuration: PropTypes.number,\n  container: PropTypes.oneOfType([PropTypes.object, PropTypes.func]),\n  disableEscapeKeyDown: PropTypes.bool,\n  disablePortal: PropTypes.bool,\n  disableRestoreFocus: PropTypes.bool,\n  duration: PropTypes.number.isRequired,\n  inputRange: PropTypes.array,\n  lockScroll: PropTypes.bool,\n  onClose: PropTypes.func,\n  onEscapeKeyDown: PropTypes.func,\n  onRendered: PropTypes.func,\n  open: PropTypes.bool.isRequired,\n  openDuration: PropTypes.number,\n  showUndersheet: PropTypes.bool,\n  undersheet: PropTypes.any\n};\nModal.defaultProps = {\n  animated: false,\n  disableEscapeKeyDown: false,\n  disablePortal: false,\n  disableRestoreFocus: false,\n  duration: 320,\n  inputRange: [0, 1],\n  lockScroll: true,\n  showUndersheet: true,\n  undersheet: Undersheet\n};\nexport default Modal;","map":{"version":3,"sources":["C:/Users/Evan_/stream-dolby-voxeet/src/components/Modal/Modal.js"],"names":["React","Component","cloneElement","PropTypes","keycode","styled","Animated","Easing","GetRef","Portal","Undersheet","ModalRoot","div","theme","z","modal","isHidden","Modal","getDerivedStateFromProps","nextProps","open","exited","constructor","props","_anim","Value","handleOpen","animated","duration","openDuration","document","addEventListener","handleDocumentKeyDown","timing","animatedValue","toValue","easing","bezier","start","handleOpened","setValue","handleRendered","onRendered","modalRef","scrollTop","handleClose","closeDuration","removeEventListener","overshootClamping","handleExited","setState","handleUndersheetClick","e","target","currentTarget","onClose","defaultPrevented","onEscapeKeyDown","disableEscapeKeyDown","handlePortalRef","ref","mountNode","getMountNode","handleModalRef","onRootRef","dialogRef","hasOwnProperty","state","componentDidMount","componentDidUpdate","prevProps","componentWillUnmount","defaultUndersheetAnim","inputRange","opacity","interpolate","outputRange","render","children","container","disablePortal","lockScroll","showUndersheet","undersheet","UndersheetComponent","undersheetStyle","other","undefined","propTypes","bool","instanceOf","element","className","string","number","oneOfType","object","func","disableRestoreFocus","isRequired","array","any","defaultProps"],"mappings":"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","sourcesContent":["import React, { Component, cloneElement } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport keycode from 'keycode';\r\nimport styled from 'styled-components';\r\nimport Animated from 'animated/lib/targets/react-dom';\r\nimport Easing from 'animated/lib/Easing';\r\n\r\n// Utils //\r\nimport GetRef from 'utils/GetRef';\r\nimport Portal from 'utils/Portal';\r\n\r\n// Components //\r\nimport Undersheet from './Undersheet';\r\n\r\nconst ModalRoot = styled(Animated.div)`\r\n    display: flex;\r\n    flex-direction: row;\r\n    justify-content: center;\r\n    position: fixed;\r\n    z-index: ${({ theme }) => theme.z.modal};\r\n    top: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n    left: 0;\r\n    visibility: ${({ isHidden }) => (isHidden ? 'hidden' : 'visible')};\r\n`;\r\n\r\nclass Modal extends Component {\r\n    _anim = new Animated.Value(0);\r\n\r\n    static getDerivedStateFromProps(nextProps) {\r\n        if (nextProps.open) {\r\n            return {\r\n                exited: false,\r\n            };\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    static propTypes = {\r\n        animated: PropTypes.bool,\r\n        animatedValue: PropTypes.instanceOf(Animated.Value),\r\n        children: PropTypes.element,\r\n        className: PropTypes.string,\r\n        closeDuration: PropTypes.number,\r\n        container: PropTypes.oneOfType([PropTypes.object, PropTypes.func]),\r\n        disableEscapeKeyDown: PropTypes.bool,\r\n        disablePortal: PropTypes.bool,\r\n        disableRestoreFocus: PropTypes.bool,\r\n        duration: PropTypes.number.isRequired,\r\n        inputRange: PropTypes.array,\r\n        lockScroll: PropTypes.bool,\r\n        onClose: PropTypes.func,\r\n        onEscapeKeyDown: PropTypes.func,\r\n        onRendered: PropTypes.func,\r\n        open: PropTypes.bool.isRequired,\r\n        openDuration: PropTypes.number,\r\n        showUndersheet: PropTypes.bool,\r\n        undersheet: PropTypes.any,\r\n    };\r\n\r\n    static defaultProps = {\r\n        animated: false,\r\n        disableEscapeKeyDown: false,\r\n        disablePortal: false,\r\n        disableRestoreFocus: false,\r\n        duration: 320,\r\n        inputRange: [0, 1],\r\n        lockScroll: true,\r\n        showUndersheet: true,\r\n        undersheet: Undersheet,\r\n    };\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.animatedValue = props.hasOwnProperty('animatedValue') ? this.props.animatedValue : this._anim; // eslint-disable-line no-prototype-builtins\r\n        this.state = {\r\n            exited: !props.open,\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (this.props.open) {\r\n            this.handleOpen();\r\n        }\r\n    }\r\n\r\n    componentDidUpdate(prevProps) {\r\n        if (prevProps.open && !this.props.open) {\r\n            this.handleClose();\r\n        } else if (!prevProps.open && this.props.open) {\r\n            this.handleOpen();\r\n        }\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        if (this.props.open || !this.state.exited) {\r\n            this.handleClose();\r\n        }\r\n    }\r\n\r\n    handleOpen = () => {\r\n        const { animated, duration, openDuration } = this.props;\r\n        document.addEventListener('keydown', this.handleDocumentKeyDown);\r\n\r\n        if (animated) {\r\n            Animated.timing(this.animatedValue, {\r\n                toValue: 1,\r\n                duration: openDuration || duration,\r\n                easing: Easing.bezier(0.0, 0.0, 0.2, 1),\r\n            }).start(() => this.handleOpened());\r\n        } else {\r\n            this.animatedValue.setValue(1);\r\n            this.handleOpened();\r\n        }\r\n    };\r\n\r\n    handleRendered = () => {\r\n        if (this.props.onRendered) {\r\n            this.props.onRendered();\r\n        }\r\n\r\n        if (this.props.open) {\r\n            this.handleOpened();\r\n        }\r\n    };\r\n\r\n    handleOpened = () => {\r\n        // Fix a bug on Chrome where the scroll isn't initially 0.\r\n        if (this.modalRef) {\r\n            this.modalRef.scrollTop = 0;\r\n        }\r\n    };\r\n\r\n    handleClose = () => {\r\n        const { animated, closeDuration, duration } = this.props;\r\n\r\n        document.removeEventListener('keydown', this.handleDocumentKeyDown);\r\n        if (animated) {\r\n            Animated.timing(this.animatedValue, {\r\n                toValue: 0,\r\n                overshootClamping: true,\r\n                duration: closeDuration || duration,\r\n                easing: Easing.bezier(0.4, 0.0, 1, 1),\r\n            }).start(() => this.handleExited());\r\n        } else {\r\n            this.animatedValue.setValue(0);\r\n            this.handleExited();\r\n        }\r\n    };\r\n\r\n    handleExited = () => {\r\n        this.setState({ exited: true });\r\n    };\r\n\r\n    handleUndersheetClick = (e) => {\r\n        if (e.target !== e.currentTarget) {\r\n            return;\r\n        }\r\n\r\n        if (this.props.onClose) {\r\n            this.props.onClose(e);\r\n        }\r\n    };\r\n\r\n    handleDocumentKeyDown = (e) => {\r\n        // Ignore events that have been `e.preventDefault()` marked.\r\n        if (keycode(e) !== 'esc' || e.defaultPrevented) {\r\n            return;\r\n        }\r\n\r\n        if (this.props.onEscapeKeyDown) {\r\n            this.props.onEscapeKeyDown(e);\r\n        }\r\n\r\n        if (!this.props.disableEscapeKeyDown && this.props.onClose) {\r\n            this.props.onClose(e);\r\n        }\r\n    };\r\n\r\n    handlePortalRef = (ref) => {\r\n        this.mountNode = ref ? ref.getMountNode() : ref;\r\n    };\r\n\r\n    handleModalRef = (ref) => {\r\n        this.modalRef = ref;\r\n    };\r\n\r\n    onRootRef = (ref) => {\r\n        this.dialogRef = ref;\r\n    };\r\n\r\n    get defaultUndersheetAnim() {\r\n        const { inputRange } = this.props;\r\n        return {\r\n            opacity: this.animatedValue.interpolate({\r\n                inputRange,\r\n                outputRange: [0, 1],\r\n            }),\r\n        };\r\n    }\r\n\r\n    render() {\r\n        const {\r\n            children,\r\n            container,\r\n            disablePortal,\r\n            lockScroll,\r\n            showUndersheet,\r\n            undersheet: UndersheetComponent,\r\n            undersheetStyle,\r\n            open,\r\n            onClose,\r\n            ...other\r\n        } = this.props;\r\n\r\n        const { exited } = this.state;\r\n\r\n        return (\r\n            <Portal\r\n                ref={this.handlePortalRef}\r\n                container={container}\r\n                disablePortal={disablePortal}\r\n                unmount={exited}\r\n                onRendered={this.handleRendered}\r\n            >\r\n                <ModalRoot isHidden={exited} ref={this.handleModalRef} {...other}>\r\n                    <UndersheetComponent\r\n                        pointerEvents={open ? 'auto' : 'none'}\r\n                        show={showUndersheet}\r\n                        open={!exited}\r\n                        style={undersheetStyle || this.defaultUndersheetAnim}\r\n                        onClick={open ? this.handleUndersheetClick : undefined}\r\n                    />\r\n                    <GetRef rootRef={this.onRootRef}>{!exited ? cloneElement(children, { onClose }) : null}</GetRef>\r\n                    <ScrollLock isActive={!exited && lockScroll} />\r\n                </ModalRoot>\r\n            </Portal>\r\n        );\r\n    }\r\n}\r\n\r\nexport default Modal;\r\n"]},"metadata":{},"sourceType":"module"}